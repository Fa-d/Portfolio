name: CI

on:
  push:
    branches: [master]

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
      with:
        repository: Fa-d/Portfolio
        token: ${{ secrets.API_TOKEN_GITHUB }}

    - name: Copy directory
      run: |
        cp -r dist/* ./ 

    - name: Commit files
      run: |
        cd target-dir
        git init
        git config --local user.name "Fa-d"
        git config --local user.email "fsadakathussain@gmail.com"
        git add .
        git commit -m "Sync directory from source repository"

    - name: Push to target repository
      env:
        TARGET_REPO_PAT: ${{ secrets.API_TOKEN_GITHUB }}
      run: |
        cd target-dir
        git remote add origin https://${{ secrets.API_TOKEN_GITHUB }}@github.com/fa-d/Fa-d.github.io.git
        git branch -M main
        git push -u origin main --force


